<?xml version="1.0" encoding="utf-8"?>
<serviceDescription>
  <id>DatabaseTransport-Sample-People-Insert</id>
  <defaultLocale>en-us</defaultLocale>
  <transportId>com.ibm.support.examples.services.DatabaseTransport.id</transportId>
  <name xml:lang="en-us">DatabaseTransport - Add Person</name>
  <description xml:lang="en-us"></description>
  <inbound>
  	<parameters>
       <!-- ENTER THE COLUMNS OF THE DATABASE THIS SERVICE IS FOR, THESE WILL BE USED IN THE ASSIGNMENT PART OF THE SQL QUERY-->
       <!-- IF YOU DON'T SUPPLY ANY PARAMETERS HERE THEN "*" WILL BE USED IN THE SQL QUERY -->
       <parameter>    	
    		<id>firstname</id>
        <name xml:lang="en-us">First Name</name>
        <description xml:lang="en-us"></description>
        <type>STRING</type>	
       </parameter>
       <parameter>    	
    		<id>lastname</id>
        <name xml:lang="en-us">Last Name</name>
        <description xml:lang="en-us"></description>
        <type>STRING</type>	
       </parameter>
       <parameter>    	
    		<id>email</id>
        <name xml:lang="en-us">Email</name>
        <description xml:lang="en-us"></description>
        <type>STRING</type>	
       </parameter>
       </parameters>
    <serviceMapping>
    	<constants>
    		<constant>
					<id>dbType</id>
					<!-- DataSource, DB2, MySQL, Oracle, ODBC -->
					<value>DataSource</value>
				</constant>
    		<constant>
					<id>dbName</id>
					<value>peopleDB</value>
				</constant>
				<constant>
					<id>tableName</id>
					<value>PEOPLE</value>
				</constant>
				<constant>
					<id>dbServer</id>
					<value>l2vm104.canlab.ibm.com</value>
				</constant>
				<constant>
					<id>dbPort</id>
					<value>50000</value>
				</constant>
				<constant>
					<id>WAS-J2CAlias</id>
					<value>IBM464-PC0DTDP2Node01/peopleDB</value>
				</constant>
				<constant>
					<id>action</id>
					<value>insert</value>
				</constant>
    	</constants>
    	<mapping>
		  	<mapping target="transport:dbName" source="constant:dbName"/>
		  	<mapping target="transport:tableName" source="constant:tableName"/>
		  	<mapping target="transport:dbType" source="constant:dbType"/>
		  	<mapping target="transport:dbServer" source="constant:dbServer"/>
		  	<mapping target="transport:dbPort" source="constant:dbPort"/>
		  	<mapping target="transport:WAS-J2CAlias" source="constant:WAS-J2CAlias"/>
		  	<mapping target="transport:action" source="constant:action"/>
		  	<!-- ADD AN ENTRY HERE FOR EACH COLUMN OF THE TABLE - ALSO LISTED ABOVE -->
		  	<mapping target="transport:assign_firstname" source="parameter:firstname"/>
		  	<mapping target="transport:assign_lastname" source="parameter:lastname"/>
		  	<mapping target="transport:assign_email" source="parameter:email"/>
		  	<!-- END OF TABLE COLUMNS -->
		  </mapping>
    </serviceMapping>
  </inbound>
  <outbound>
  <parameters>
            <parameter>
		        <id>response</id>
		        <name xml:lang="en-us">Response</name>
		        <description xml:lang="en-us"></description>
		        <mandatory>false</mandatory>
		        <type>INTEGER</type>
		      </parameter>
		      <parameter>    	
    		<id>firstname</id>
        <name xml:lang="en-us">First Name</name>
        <description xml:lang="en-us"></description>
        <type>STRING</type>	
       </parameter>
       <parameter>    	
    		<id>lastname</id>
        <name xml:lang="en-us">Last Name</name>
        <description xml:lang="en-us"></description>
        <type>STRING</type>	
       </parameter>
       <parameter>    	
    		<id>email</id>
        <name xml:lang="en-us">Email</name>
        <description xml:lang="en-us"></description>
        <type>STRING</type>	
       </parameter>
		      <parameter>
				<id>queryResults</id>
				<type>LIST</type>
				<name xml:lang="en-us">Query Results</name>
				<description xml:lang="en-us">This will contain the query results if there are any (from a select)</description>
				<parameters>
				<!-- need to list all the possible columns that can be returned from the table-->
				<!-- the problem with this is that it is specific to each table...-->
				<!-- the only way around this would be to return XML, but then can't map directly to fields -->
					<parameter>
						<id>firstname</id>
						<type>STRING</type>
						<name xml:lang="en-us">First Name</name>
						<description xml:lang="en-us"></description>
					</parameter>
					<parameter>
						<id>lastname</id>
						<type>STRING</type>
						<name xml:lang="en-us">Last Name</name>
						<description xml:lang="en-us"></description>
					</parameter>
					<parameter>
						<id>email</id>
						<type>STRING</type>
						<name xml:lang="en-us">Email</name>
						<description xml:lang="en-us"></description>
					</parameter>
				</parameters>
			</parameter>
			<parameter>
						<id>rowCount</id>
						<type>STRING</type>
						<name xml:lang="en-us">Rows Affected/Count</name>
						<description xml:lang="en-us"></description>
					</parameter>
	</parameters>
	<serviceMapping>
        <mapping>
            <mapping source="transport:success" sourceType="STRING" target="parameter:response" targetType="STRING" />
            <mapping source="transport:rowsAffected" sourceType="STRING" target="parameter:rowCount" targetType="STRING" />
            
            <mapping source="transport:FIRSTNAME" sourceType="STRING" target="parameter:firstname" targetType="STRING" />
            <mapping source="transport:LASTNAME" sourceType="STRING" target="parameter:lastname" targetType="STRING" />
            <mapping source="transport:EMAIL" sourceType="STRING" target="parameter:email" targetType="STRING" />
            <mapping source="transport:queryResults" target="parameter:queryResults">
            <!-- The transport writes back all the columns but these need to be in the transport so that the -->
            <!-- form developer can link the outputs to their form -->
            <!-- The response is dependent on the database, case matters here! If the output is not working then you may
                 need to enable com.ibm.form.*=finest in the WAS trace and look at the service output to determine the necessary
                 format.
                 
                 For example DB2 returns the columns in upper case, as listed below. -->
							<mapping source="transport:FIRSTNAME" target="parameter:firstname" />
							<mapping source="transport:LASTNAME" target="parameter:lastname" />
							<mapping source="transport:EMAIL" target="parameter:email" />
						</mapping>
        </mapping>
    </serviceMapping>
  </outbound>
</serviceDescription>